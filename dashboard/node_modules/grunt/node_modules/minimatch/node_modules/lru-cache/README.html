<h1 id="lru_cache">lru cache</h1>
<p>A cache object that deletes the least-recently-used items.</p>
<h2 id="Usage:">Usage:</h2>
<pre><code class="javascript"><span class="keyword">var</span> LRU = <span class="built_in">require</span>(<span class="string">"lru-cache"</span>)
  , options = { max: <span class="number">500</span>
              , length: <span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span> <span class="keyword">return</span> n * <span class="number">2</span> }
              , dispose: <span class="function"><span class="keyword">function</span> <span class="params">(key, n)</span> {</span> n.close() }
              , maxAge: <span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> }
  , cache = LRU(options)
  , otherCache = LRU(<span class="number">50</span>) <span class="comment">// sets just the max size</span>

cache.set(<span class="string">"key"</span>, <span class="string">"value"</span>)
cache.get(<span class="string">"key"</span>) <span class="comment">// "value"</span>

cache.reset()    <span class="comment">// empty the cache</span>
</code></pre>
<p>If you put more stuff in it, then items will fall out.</p>
<p>If you try to put an oversized thing in it, then it’ll fall out right<br>away.</p>
<h2 id="Options">Options</h2>
<ul>
<li><code>max</code> The maximum size of the cache, checked by applying the length<br>function to all values in the cache.  Not setting this is kind of<br>silly, since that’s the whole purpose of this lib, but it defaults<br>to <code>Infinity</code>.</li>
<li><code>maxAge</code> Maximum age in ms.  Items are not pro-actively pruned out<br>as they age, but if you try to get an item that is too old, it’ll<br>drop it and return undefined instead of giving it to you.</li>
<li><code>length</code> Function that is used to calculate the length of stored<br>items.  If you’re storing strings or buffers, then you probably want<br>to do something like <code>function(n){return n.length}</code>.  The default is<br><code>function(n){return 1}</code>, which is fine if you want to store <code>n</code><br>like-sized things.</li>
<li><code>dispose</code> Function that is called on items when they are dropped<br>from the cache.  This can be handy if you want to close file<br>descriptors or do other cleanup tasks when items are no longer<br>accessible.  Called with <code>key, value</code>.  It’s called <em>before</em><br>actually removing the item from the internal cache, so if you want<br>to immediately put it back in, you’ll have to do that in a<br><code>nextTick</code> or <code>setTimeout</code> callback or it won’t do anything.</li>
<li><code>stale</code> By default, if you set a <code>maxAge</code>, it’ll only actually pull<br>stale items out of the cache when you <code>get(key)</code>.  (That is, it’s<br>not pre-emptively doing a <code>setTimeout</code> or anything.)  If you set<br><code>stale:true</code>, it’ll return the stale value before deleting it.  If<br>you don’t set this, then it’ll return <code>undefined</code> when you try to<br>get a stale entry, as if it had already been deleted.</li>
</ul>
<h2 id="API">API</h2>
<ul>
<li><code>set(key, value, max)</code></li>
<li><p><code>get(key) =&gt; value</code></p>
<p>  Both of these will update the “recently used”-ness of the key.<br>  They do what you think. <code>max</code> is optional and overrides the<br>  cache <code>max</code> option if provided.</p>
</li>
<li><p><code>peek(key)</code></p>
<p>  Returns the key value (or <code>undefined</code> if not found) without<br>  updating the “recently used”-ness of the key.</p>
<p>  (If you find yourself using this a lot, you <em>might</em> be using the<br>  wrong sort of data structure, but there are some use cases where<br>  it’s handy.)</p>
</li>
<li><p><code>del(key)</code></p>
<p>  Deletes a key out of the cache.</p>
</li>
<li><p><code>reset()</code></p>
<p>  Clear the cache entirely, throwing away all values.</p>
</li>
<li><p><code>has(key)</code></p>
<p>  Check if a key is in the cache, without updating the recent-ness<br>  or deleting it for being stale.</p>
</li>
<li><p><code>forEach(function(value,key,cache), [thisp])</code></p>
<p>  Just like <code>Array.prototype.forEach</code>.  Iterates over all the keys<br>  in the cache, in order of recent-ness.  (Ie, more recently used<br>  items are iterated over first.)</p>
</li>
<li><p><code>keys()</code></p>
<p>  Return an array of the keys in the cache.</p>
</li>
<li><p><code>values()</code></p>
<p>  Return an array of the values in the cache.</p>
</li>
<li><p><code>length()</code></p>
<p>  Return total length of objects in cache taking into account<br>  <code>length</code> options function.</p>
</li>
<li><p><code>itemCount()</code></p>
<p>  Return total quantity of objects currently in cache. Note, that<br>  <code>stale</code> (see options) items are returned as part of this item<br>  count.</p>
</li>
</ul>

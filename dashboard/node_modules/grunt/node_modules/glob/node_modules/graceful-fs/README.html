<h1 id="graceful-fs">graceful-fs</h1>
<p>graceful-fs functions as a drop-in replacement for the fs module,<br>making various improvements.</p>
<p>The improvements are meant to normalize behavior across different<br>platforms and environments, and to make filesystem access more<br>resilient to errors.</p>
<h2 id="Improvements_over_fs_module">Improvements over fs module</h2>
<p>graceful-fs:</p>
<ul>
<li>keeps track of how many file descriptors are open, and by default<br>limits this to 1024. Any further requests to open a file are put in a<br>queue until new slots become available. If 1024 turns out to be too<br>much, it decreases the limit further.</li>
<li>fixes <code>lchmod</code> for Node versions prior to 0.6.2.</li>
<li>implements <code>fs.lutimes</code> if possible. Otherwise it becomes a noop.</li>
<li>ignores <code>EINVAL</code> and <code>EPERM</code> errors in <code>chown</code>, <code>fchown</code> or<br><code>lchown</code> if the user isnâ€™t root.</li>
<li>makes <code>lchmod</code> and <code>lchown</code> become noops, if not available.</li>
<li>retries reading a file if <code>read</code> results in EAGAIN error.</li>
</ul>
<p>On Windows, it retries renaming a file for up to one second if <code>EACCESS</code><br>or <code>EPERM</code> error occurs, likely because antivirus software has locked<br>the directory.</p>
<h2 id="Configuration">Configuration</h2>
<p>The maximum number of open file descriptors that graceful-fs manages may<br>be adjusted by setting <code>fs.MAX_OPEN</code> to a different number. The default<br>is 1024.</p>
